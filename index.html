<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Finite Automata Practice ‚Äî Enhanced Interactive Studio</title>
  <link rel="icon" href="data:;base64,iVBORw0KGgo=">
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div id="splashScreen"
    style="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea,#764ba2);z-index:9999;flex-direction:column;gap:20px;color:#fff;transition:opacity 0.8s ease;">
    <h1 style="font-size:3.5rem;margin:0;text-shadow:0 4px 12px rgba(0,0,0,0.4);">
      Enhanced Studio
    </h1>
    <div style="display:flex; gap: 20px;">
      <button class="splash-nav-btn" data-target="Automata"
        style="all:unset;padding:15px 30px; border-radius:12px; font-size:1.5rem; background: rgba(255,255,255,0.2); backdrop-filter: blur(5px); cursor:pointer; font-weight:700; transition: background 0.3s;">
        Finite Automata
      </button>
       <button class="splash-nav-btn" data-target="PDA" disabled
        style="all:unset;padding:15px 30px; border-radius:12px; font-size:1.5rem; background: rgba(255,255,255,0.05); cursor:not-allowed; opacity:0.6; font-weight:700;">
        PDA (Coming Soon)
      </button>
      <button class="splash-nav-btn" data-target="Turing" disabled
        style="all:unset;padding:15px 30px; border-radius:12px; font-size:1.5rem; background: rgba(255,255,255,0.05); cursor:not-allowed; opacity:0.6; font-weight:700;">
        Turing (Coming Soon)
      </button>
    </div>
  </div>
  <div id="mainApp" style="display:none">
    <div class="app-container" role="application" aria-label="Finite Automata Practice Studio">
      <header class="header">
        <h1>Finite Automata Practice</h1>
      </header>
      <main class="main-content">
        <aside class="control-panel" aria-label="Controls">
          <div class="section-title">‚öôÔ∏è Mode & Interaction</div>
          <div style="display:flex;gap:8px;margin-bottom:12px">
            <select id="modeSelect" aria-label="Mode select"
              style="flex:1;padding:10px;border-radius:10px;border:1px solid #e6eef8">
              <option value="DFA">DFA</option>
              <option value="NFA">NFA</option>
              <option value="ENFA">Œµ-NFA</option>
              <option value="ENFA_TO_NFA">Œµ-NFA ‚Üí NFA</option>
              <option value="NFA_TO_DFA">NFA ‚Üí DFA</option>
              <option value="NFA_TO_MIN_DFA">NFA ‚Üí Minimal DFA</option>
              <option value="DFA_TO_MIN_DFA">DFA ‚Üí Minimal DFA</option>
            </select>
          </div>
          <details class="control-section" open>
            <summary
              style="cursor:pointer; font-weight:600; color:#374151; background:linear-gradient(90deg,#fff,#f7fafc); padding:6px 8px; border-radius:8px;">
              üß©
              Practice Generator</summary>
            <div style="padding:8px 6px;">
              <div style="margin-bottom:12px">
                <div style="display:flex;gap:8px">
                  <select id="practiceMode" style="flex:1;padding:10px;border-radius:10px;border:1px solid #e6eef8">
                    <option value="basic">Basic</option>
                    <option value="medium">Medium</option>
                    <option value="easy">Easy</option>
                    <option value="hard">Hard</option>
                  </select>
                  <button class="icon-btn" id="genPracticeBtn">Generate</button>
                </div>
                <div style="display:flex;gap:8px;margin-top:8px;align-items:center">
                  <button class="icon-btn" id="showSolBtn">Show Solution</button>
                  <button class="icon-btn" id="resetPractice">Reset</button>
                  <button class="icon-btn" id="checkAnswerBtn">Check Answer</button>
                </div>
                <div
                  style="margin-top:10px;padding:10px;border-radius:10px;background:linear-gradient(180deg,#fff,#fbfdff);border:1px solid #eef2ff;min-height:120px"
                  id="practiceBox">No practice generated yet.</div>
              </div>
            </div>
          </details>
          <details class="control-section">
            <summary
              style="cursor:pointer; font-weight:600; color:#374151; background:linear-gradient(90deg,#fff,#f7fafc); padding:6px 8px; border-radius:8px;">
              üß™
              Testing</summary>
            <div style="padding:8px 6px;">
              <div class="controls-group">
                <div class="test-panel">
                  <div class="input"><input id="testInput" placeholder="Enter string (e.g., abbab)" /></div>
                  <button id="runTestBtn" class="run-btn">Run</button>
                </div>
                <div id="randomStringBox"
                  style="margin:6px 0; font-size:0.9em; background:linear-gradient(90deg,#fff,#f7fafc); padding:6px 8px; border-radius:8px;">
                  üé≤ <button id="genRandBtn" class="icon-btn">Random</button>
                </div>
                <details id="testOptionsCollapse" style="margin:6px 0; font-size:0.9em;">
                  <summary
                    style="cursor:pointer; font-weight:600; color:#374151; background:linear-gradient(90deg,#fff,#f7fafc); padding:6px 8px; border-radius:8px;">
                    ‚öôÔ∏è Simulation Options</summary>
                  <div id="testOptions" style="padding:8px 6px;">
                    <label style="margin-right:8px;"><input type="radio" name="simMode" value="auto" checked>
                      Auto</label>
                    <label style="margin-right:8px;"><input type="radio" name="simMode" value="manual"> Manual</label>
                    <label style="display:inline-flex;align-items:center;gap:6px;">Speed:
                      <select id="testSpeed"
                        style="margin-left:6px;padding:6px;border-radius:6px;border:1px solid #e6eef8">
                        <option value="500">Fast</option>
                        <option value="1000">Normal</option>
                        <option value="2000" selected>Slow</option>
                      </select>
                    </label>
                    <div id="manualButtons" style="display:none;margin-top:8px;display:flex;gap:6px;">
                      <button id="stepPrev" class="icon-btn">‚óÄ Prev</button>
                      <button id="stepNext" class="icon-btn">Next ‚ñ∂</button>
                      <button id="stepReset" class="icon-btn">‚ü≤ Reset</button>
                    </div>
                  </div>
                </details>
                <div style="margin-top:8px" id="testOutput" class="output-display">Ready</div>
              </div>
            </div>

            <div style="padding:8px 6px;border-top:1px solid #e6eef8;margin-top:8px;">
              <details id="bulkTestSection">
                <summary
                  style="cursor:pointer;font-weight:600;color:#374151;background:linear-gradient(90deg,#fff,#f7fafc);padding:6px 8px;border-radius:8px;margin-bottom:8px;">
                  Bulk Testing</summary>
                <div style="padding:8px 4px;">
                  <textarea id="bulkTestInput" placeholder="Enter test strings (one per line)..."
                    style="width:100%;min-height:100px;padding:8px;border-radius:8px;border:1px solid #e6eef8;font-family:monospace;font-size:0.9em;"></textarea>
                  <button id="bulkRunBtn" class="icon-btn" style="margin-top:8px;width:100%;">Run Bulk Test</button>
                  <div id="bulkTestOutput"
                    style="margin-top:8px;white-space:pre-wrap;font-size:0.9em;background:linear-gradient(180deg,#fff,#fbfdff);padding:8px;border-radius:8px;border:1px solid #eef2ff;min-height:60px;">
                  </div>
                </div>
              </details>
            </div>
          </details>
          <details class="control-section">
            <summary
              style="cursor:pointer; font-weight:600; color:#374151; background:linear-gradient(90deg,#fff,#f7fafc); padding:6px 8px; border-radius:8px;">
              üìÅ
              File</summary>
            <div class="control-row">
              <button id="saveMachineBtn" title="Save machine (JSON)">üíæ Save</button>
              <button id="loadMachineBtn" title="Load machine (JSON)">üìÇ Load</button>
            </div>
            <div class="control-row">
              <button id="exportPngBtn" title="Export canvas as PNG">üñºÔ∏è Export PNG</button>
            </div>
            <input type="file" id="loadFileInput" accept=".json" style="display:none" />
          </details>


          <details class="control-section" id="librarySection" style="margin-top:8px;">
            <summary
              style="cursor:pointer;font-weight:600;color:#374151;background:linear-gradient(90deg,#fff,#f7fafc);padding:8px;border-radius:8px;">
              üìö Library
            </summary>
            <div style="padding:8px;">
              <div style="display:flex;gap:8px;margin-bottom:10px;align-items:center">
                <input id="libSearch" placeholder="Search by title, id, alphabet, or description"
                  style="flex:1;padding:8px;border-radius:8px;border:1px solid #e6eef8" />
                <select id="libFilter" style="padding:8px;border-radius:8px;border:1px solid #e6eef8">
                  <option value="all">All Types</option>
                  <option value="DFA">DFA</option>
                  <option value="NFA">NFA</option>
                  <option value="ENFA">Œµ-NFA</option>
                </select>
                <button id="libRefresh" class="icon-btn" title="Refresh library">Refresh</button>
              </div>
              <div id="libraryList"
                style="display:flex;flex-direction:column;gap:8px;max-height:28vh;overflow:auto;padding:6px;border-radius:8px;border:1px solid #eef2ff;background:linear-gradient(180deg,#fff,#fbfdff)">
                <div style="color:#94a3b8;padding:8px">Library empty ‚Äî click Refresh to load library.json</div>
              </div>
              <div style="margin-top:8px;display:flex;gap:8px">
                <button id="openLibJson" class="icon-btn">Open library.json</button>
                <button id="downloadLib" class="icon-btn">Download ZIP</button>
              </div>
            </div>
          </details>
        </aside>
        <section class="visualization-panel" aria-label="Visualization" style="position: relative;">
          <div class="visualization-header" style="display:flex;align-items:center;gap:12px;">
            <div style="flex:1"><strong>Automata Visualization</strong>
              <div class="kv">Mode: <span id="modeLabel">DFA</span></div>
            </div>
          </div>
          <div class="canvas-wrapper" id="canvasWrapper">
            <div class="canvas-top">
              <div class="canvas-toolbar" role="toolbar" aria-label="Canvas toolbar">
                <div class="toolbar-icon" id="tool-addclick" title="Add state on canvas click" data-mode="addclick"><i
                    data-lucide="plus-circle" style="color:#4caf50"></i></div>
                <div class="toolbar-icon" id="tool-move" title="Move states" data-mode="move"><i data-lucide="move"
                    style="color:#2196f3"></i></div>
                <div class="toolbar-icon" id="tool-transition" title="Add transition" data-mode="transition"><i
                    data-lucide="git-branch" style="color:#9c27b0"></i></div>
                <div class="toolbar-icon" id="tool-rename" title="Rename state" data-mode="rename"><i
                    data-lucide="edit-3" style="color:#009688"></i></div>
                <div class="toolbar-icon" id="tool-delete" title="Delete state/transition" data-mode="delete"><i
                    data-lucide="trash-2" style="color:#f44336"></i></div>
                <div class="toolbar-icon" id="tool-stateprops" title="Set state properties" data-mode="stateprops"><i
                    data-lucide="settings" style="color:#607d8b"></i></div>

                <button id="validateBtn" class="toolbar-icon" title="Validate Automaton" style="margin-left:8px"><i
                    data-lucide="check-circle"></i></button>

                <div class="toolbar-icon" id="clearCanvasBtn" title="Clear Canvas"><i data-lucide="file-x"
                    style="color:#f44336;"></i></div>

                <div id="validationLine" class="validation-box"></div>

                <button id="undoBtn" class="toolbar-icon" title="Undo" style="margin-left:auto;"><i
                    data-lucide="corner-up-left" style="color:#607d8b;"></i></button>
                <button id="redoBtn" class="toolbar-icon" title="Redo"><i data-lucide="corner-up-right"
                    style="color:#607d8b;"></i></button>
              </div>
            </div>
            <div class="canvas-area">
              <div class="svg-canvas" id="svgWrapper" tabindex="0">
                <svg id="dfaSVG" viewBox="0 0 1400 900" xmlns="http://www.w3.org/2000/svg" role="img"
                  aria-label="Automaton canvas">
                  <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                      <polygon points="0 0, 10 3.5, 0 7" fill="#667eea" />
                    </marker>
                    <marker id="arrowhead-export" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                      <polygon points="0 0, 10 3.5, 0 7" fill="#000000" />
                    </marker>
                  </defs>
                  <g id="edges"></g>
                  <g id="states"></g>
                  <text id="canvasHint" x="700" y="420" text-anchor="middle" fill="#9aa6b2" font-size="18">Tap canvas to
                    add a state (use ‚ûï tool)</text>
                </svg>
              </div>
            </div>
          </div>

          <div class="zoom-controls" style="position: absolute; right: 30px; top: 150px; z-index: 50;">
            <button id="zoomInBtn" class="toolbar-icon" title="Zoom In"><i data-lucide="zoom-in"></i></button>
            <input id="zoomSlider" type="range" min="50" max="200" value="100" />
            <button id="zoomOutBtn" class="toolbar-icon" title="Zoom Out"><i data-lucide="zoom-out"></i></button>
            <button id="zoomResetBtn" class="toolbar-icon" title="Reset Zoom"><i data-lucide="refresh-ccw"></i></button>
          </div>
        </section>
      </main>
      <div style="max-width:1400px;margin:8px auto 0 auto;padding:0 18px;">
        <div style="display:flex;gap:12px;align-items:center;margin-top:8px">
          <div style="flex:1" id="stepLog">Step log appears here.</div>
        </div>
      </div>
    </div>

    <!-- MODALS -->
    <div id="transitionModal" class="modal-overlay" style="display:none">
      <div class="modal-box">
        <h3>Add Transition</h3>
        <div style="display:flex;gap:8px;margin-bottom:8px">
          <input id="transFrom" class="modal-input" placeholder="from (q0)" readonly />
          <input id="transTo" class="modal-input" placeholder="to (q1)" readonly />
        </div>
        <input id="transSymbol" class="modal-input" placeholder="symbol (blank for Œµ)" />
        <div class="modal-actions">
          <button id="transCancel">Cancel</button>
          <button id="transSave">Save</button>
        </div>
      </div>
    </div>
    <div id="statePropsModal" class="modal-overlay" style="display:none">
      <div class="modal-box">
        <h3>State Properties</h3>
        <div class="modal-prop-row"><label><input type="checkbox" id="propInitial"> Initial State</label></div>
        <div class="modal-prop-row"><label><input type="checkbox" id="propFinal"> Final State</label></div>
        <div class="modal-actions">
          <button id="propCancel">Cancel</button>
          <button id="propSave">Save</button>
        </div>
      </div>
    </div>
    <div id="renameModal" class="modal-overlay" style="display:none">
        <div class="modal-box">
            <h3>Rename State</h3>
            <p class="modal-description">Enter the new name for the state.</p>
            <input id="renameInput" class="modal-input" placeholder="New state name" />
            <div class="modal-actions">
                <button id="renameCancel">Cancel</button>
                <button id="renameSave">Save</button>
            </div>
        </div>
    </div>
    <div id="confirmClearModal" class="modal-overlay" style="display:none">
        <div class="modal-box">
            <h3>Clear Canvas</h3>
            <p class="modal-description">Are you sure you want to clear the entire canvas? This action can be undone.</p>
            <div class="modal-actions">
                <button id="confirmClearCancel">Cancel</button>
                <button id="confirmClearConfirm" class="danger-btn">Clear Canvas</button>
            </div>
        </div>
    </div>
    <!-- NEW: Alert Modal -->
    <div id="alertModal" class="modal-overlay" style="display:none">
        <div class="modal-box">
            <h3 id="alertTitle">Alert</h3>
            <p id="alertMessage" class="modal-description"></p>
            <div class="modal-actions">
                <button id="alertOk">OK</button>
            </div>
        </div>
    </div>
  </div>

  <script src="practice-bank.js" defer></script>
  <script src="library-loader.js" defer></script>
  <script type="module" src="library_helper.js"></script>
  <script type="module" src="main.js"></script>
  <script type="module" src="state.js"></script>
  <script type="module" src="ui.js"></script>
  <script type="module" src="renderer.js"></script>
  <script type="module" src="simulation.js"></script>
  <script type="module" src="automata.js"></script>
  <script type="module" src="file.js"></script>
  <script type="module" src="practice.js"></script>
  <script type="module" src="animation.js"></script>
  <script type="module" src="utils.js"></script>

</body>

</html>


